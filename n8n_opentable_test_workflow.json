{
  "name": "OpenTable Scraper - Debug HTML",
  "nodes": [
    {
      "parameters": {},
      "id": "27018783-a079-4469-bc2a-1c7c9135e808",
      "name": "Start",
      "type": "n8n-nodes-base.start",
      "typeVersion": 1,
      "position": [
        240,
        300
      ]
    },
    {
      "parameters": {
        "url": "https://app.scrapingbee.com/api/v1/?api_key=PE0EL019IKOKWT8MID15O5HQYGEPDC9FT6EQZK8DKJ7RBLP15MGGTOB8YQQMAKFGAD8Q1VA9RRTNIPK5&url=https%3A%2F%2Fwww.opentable.com%2Fs%2F%3Fk%3Dnew%2520york",
        "options": {
          "response": {
            "response": {
              "fullResponse": false,
              "responseFormat": "string"
            }
          }
        }
      },
      "id": "8482a524-76e3-4d43-9828-569a988185c0",
      "name": "Fetch via ScrapingBee",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [
        460,
        300
      ]
    },
    {
      "parameters": {
        "values": {
          "string": [
            {
              "name": "rawHTML",
              "value": "={{ items[0].json }}"
            }
          ]
        },
        "options": {}
      },
      "id": "a1b2c3d4-e5f6-7890-1234-abcdef123456",
      "name": "See Raw HTML",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        680,
        300
      ]
    },
    {
      "parameters": {
        "jsCode": "const cheerio = require('cheerio');\n\n// NOTE: We now get the HTML from the previous 'Set' node\nconst html = items[0].json.rawHTML;\n\nconst $ = cheerio.load(html);\n\nconst nameSelector = \"h3[data-test='restaurant-card-name']\";\nconst linkSelector = \"a[data-test='restaurant-card-link']\";\nconst cuisineSelector = \"span[data-test='restaurant-card-cuisine-info']\";\nconst imageSelector = \"img[data-test='restaurant-card-image']\";\n\nconst names = $(nameSelector);\nconst results = [];\n\nnames.each((index, element) => {\n\n  const name = $(element).text();\n  const link = $(linkSelector).eq(index).attr('href');\n  const cuisine = $(cuisineSelector).eq(index).text();\n  const imageUrl = $(imageSelector).eq(index).attr('src');\n\n  results.push({\n    name: name,\n    link: link,\n    cuisine: cuisine,\n    imageUrl: imageUrl\n  });\n});\n\nreturn results;"
      },
      "id": "c61b179d-9c24-42b7-8ccb-a3d827f37ccb",
      "name": "Extract Info with Code",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        880,
        300
      ]
    }
  ],
  "connections": {
    "Start": {
      "main": [
        [
          {
            "node": "Fetch via ScrapingBee",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fetch via ScrapingBee": {
      "main": [
        [
          {
            "node": "See Raw HTML",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "See Raw HTML": {
      "main": [
        [
          {
            "node": "Extract Info with Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {}
} 