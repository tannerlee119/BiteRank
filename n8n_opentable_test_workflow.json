{
  "name": "OpenTable Scraper - Final with Headers",
  "nodes": [
    {
      "parameters": {},
      "id": "27018783-a079-4469-bc2a-1c7c9135e808",
      "name": "Start",
      "type": "n8n-nodes-base.start",
      "typeVersion": 1,
      "position": [
        240,
        300
      ]
    },
    {
      "parameters": {
        "url": "https://app.scrapingbee.com/api/v1/?api_key=PE0EL019IKOKWT8MID15O5HQYGEPDC9FT6EQZK8DKJ7RBLP15MGGTOB8YQQMAKFGAD8Q1VA9RRTNIPK5&url=https%3A%2F%2Fwww.opentable.com%2Fs%2F%3Fk%3Dnew%2520york&forward_headers=true",
        "options": {
          "response": {
            "response": {
              "fullResponse": false,
              "responseFormat": "file"
            }
          },
          "headers": {
            "header": [
              {
                "name": "User-Agent",
                "value": "curl/8.7.1"
              }
            ]
          }
        }
      },
      "id": "8482a524-76e3-4d43-9828-569a988185c0",
      "name": "Fetch via ScrapingBee",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [
        460,
        300
      ]
    },
    {
      "parameters": {
        "jsCode": "const cheerio = require('cheerio');\n\n// Get the binary data from the input item using n8n's helper function.\n// $getBinaryData(itemIndex) returns a Buffer.\nconst buffer = await $getBinaryData(0);\n\n// Convert the buffer to a UTF-8 string\nconst html = buffer.toString('utf-8');\n\nconst $ = cheerio.load(html);\n\nconst nameSelector = \"h3[data-test='restaurant-card-name']\";\nconst linkSelector = \"a[data-test='restaurant-card-link']\";\nconst cuisineSelector = \"span[data-test='restaurant-card-cuisine-info']\";\nconst imageSelector = \"img[data-test='restaurant-card-image']\";\n\nconst results = [];\n\nconst names = $(nameSelector);\n\nnames.each((index, element) => {\n  const name = $(element).text();\n  const link = $(linkSelector).eq(index).attr('href');\n  const cuisine = $(cuisineSelector).eq(index).text();\n  const imageUrl = $(imageSelector).eq(index).attr('src');\n\n  results.push({\n    name: name,\n    link: link,\n    cuisine: cuisine,\n    imageUrl: imageUrl\n  });\n});\n\nreturn results;"
      },
      "id": "dac1db94-fa39-42e0-919b-e0e70ef3c528",
      "name": "Extract Info with Code",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        680,
        300
      ]
    }
  ],
  "connections": {
    "Start": {
      "main": [
        [
          {
            "node": "Fetch via ScrapingBee",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fetch via ScrapingBee": {
      "main": [
        [
          {
            "node": "Extract Info with Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "meta": {
    "instanceId": "0192b40c03f1f0a5599cfa5317602d78af1f928c4282591b3a88a8e071138389"
  }
} 